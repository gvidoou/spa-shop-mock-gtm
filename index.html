<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>mock gtm events</title>

    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s);j.async=true;j.src="https://load.mock.stape.ink/c9axfvwulfg.js?"+i;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','7=aWQ9R1RNLUtCVjRWQkpK&sort=desc');</script>
    <!-- End Google Tag Manager -->
  </head>
  <body>
    <h1>GTM mock!</h1>
    <div class="container text-center">
        <div class="row p-3">
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('page_view')">Page View</a>
          </div>
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('view_item')">View item</a>
          </div>
          <div class="col">

            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('view_item_list')">View item list</a>
          </div>
        </div>
        <div class="row p-3">
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('view_cart')">View cart</a>
          </div>
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('begin_checkout')">Begin checkout</a>
          </div>
          <div class="col">
            
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('add_to_cart')">Add to cart</a>
          </div>

        </div>
        <div class="row p-3">
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('purchase')">Purchase</a>
          </div>
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('purchase_UA')">Purchase UA</a>
          </div>
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('purchase_ga4')">Purchase GA4</a>
            
          </div>

        </div>
        <div class="row p-3">
          <div class="col">
            <a type="button" class="btn btn-danger" href="#" onclick="pushEvent('reset')">Reset datalayer</a>
          </div>
          <!-- <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('')"></a>
          </div>
          <div class="col">
            <a type="button" class="btn btn-warning" href="#" onclick="pushEvent('')"></a>
          </div> -->
        </div>

        <div class="row-fluid pt-5">
          <div class="col">
            <div class="card">
              <div class="card-body" id="text_field"></div>
            </div>
          </div>
        </div>
      </div>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];
      let text_field = document.getElementById('text_field');
      function log(text, data) {

        console.log(text + ' datalayer event count:' + dataLayer.length);
        text_field.innerHTML = text + '<br> datalayer event count:' + dataLayer.length + '<br>' + JSON.stringify(dataLayer[dataLayer.length -1]);
        
      }

      function pushEvent(event_name) {
        if (event_name === 'page_view') {
          dataLayer.push({
            'event': 'Pageview',
            'pagePath': window.location.url,
            'pageTitle': 'Pancake Event Signup',
            'visitorType': 'customer'
          });          
        } else if (event_name === 'view_item') {
          dataLayer.push({
            event: "view_item_stape",
            user_data: {
              first_name: null,
              last_name: null,
              email: null,
              phone: null,
              city: null,
              country: null,
              zip: null,
              region: null,
              street: null,
              customer_id: null
            },
            ecommerce: {
              value: "69.9",
              currency: "EUR",
              items: [
                {
                  item_id: "999993333",
                  item_sku: "red_potion_3_50ml_Eng",
                  item_variant: "8888884444",
                  item_name: "MossElixir™ Face Cream",
                  variant_name: "Default Title",
                  item_category: "",
                  price: 69.9,
                  item_brand: "Red potion™ Face Cream",
                  imageURL: "image.png",
                  item_url: "/products/potion-3",
                  quantity: "1"
                }
              ]
            },
            actual_url: window.location.url + 'red_potion',
            ecomm_pagetype: "product",
          });
        } else if (event_name === 'add_to_cart') {
          dataLayer.push({
            event: "add_to_cart",
            user_data: {
              first_name: null,
              last_name: null,
              email: null,
              phone: null,
              city: null,
              country: null,
              zip: null,
              region: null,
              street: null,
              customer_id: null
            },
            ecommerce: {
              value: "69.9",
              currency: "USD",
              items: [
                {
                  item_id: "999993333",
                  item_sku: "red_potion_3_50ml_Eng",
                  item_variant: "8888884444",
                  item_name: "Red potion™ Face Cream",
                  variant_name: null,
                  item_category: "",
                  item_brand: "Red potion",
                  item_url: "/products/potion-3",
                  price: 69.9,
                  imageURL: "",
                  quantity: 1
                }
              ]
            },
            actual_url:  window.location.url,
            ecomm_pagetype: "product",
          });
          
        } else if (event_name === 'begin_checkout') {
          dataLayer.push({
            event: "begin_checkout",
            user_data: {
              first_name: 'Testname',
              last_name: 'Test_lastname',
              email: 'test@mail.com',
              phone: '+1234567890',
              city: 'Vicecity',
              country: 'USA',
              zip: '12345',
              region: 'NJ',
              street: 'Wallstreet',
              customer_id: '19999'
            },
            ecommerce: {
              value: "69.9",
              currency: "USD",
              cart_total: "69.9",
              cart_quantity: 1,
              items: [
                {
                  item_id: "999993333",
                  item_sku: "red_potion_3_50ml_Eng",
                  item_variant: "8888884444",
                  item_name: "Red potion™ Face Cream",
                  variant_name: null,
                  item_category: "",
                  item_brand: "Red potion",
                  item_url: "/products/potion-3",
                  price: 69.9,
                  imageURL: "",
                  quantity: 1
                }
              ]
            },
            actual_url:  window.location.url + 'checkout',
            ecomm_pagetype: "basket",
          });

        } else if (event_name === 'view_item_list') {
          dataLayer.push({
            event: "view_collection_stape",
            user_data: {
              first_name: null,
              last_name: null,
              email: null,
              phone: null,
              city: null,
              country: null,
              zip: null,
              region: null,
              street: null,
              customer_id: null
            },
            ecommerce: {
              collection_id: "639084069193",
              item_list_name: "Alle Produkte",
              currency: "USD",
              items: [
                {
                  item_id: "999993333",
                  item_sku: "red_potion_3_50ml_Eng",
                  item_variant: "8888884444",
                  item_name: "Red potion™ Face Cream",
                  variant_name: "Default Title",
                  item_category: "",
                  item_brand: "Red potion",
                  price: 69.9,
                  imageURL: "img.png",
                  item_url: "/products/potion-3",
                  index: 1
                },
                {
                  item_id: "8768519864649",
                  item_sku: "1-SE_006-02-EN-01",
                  item_variant: "49109718794569",
                  item_name: "Green Potion™ Night Repair Serum",
                  variant_name: "Default Title",
                  item_category: "",
                  item_brand: "Red potion",
                  price: 79.9,
                  imageURL: "",
                  item_url: "/products/green-potion-3",
                  index: 2
                },
              ]
            },
            actual_url: window.location.url + 'list',
            ecomm_pagetype: "category",
          });
        } else if (event_name === 'view_cart') {
          dataLayer.push({
            event: "view_cart",
            user_data: {
              first_name: null,
              last_name: null,
              email: null,
              phone: null,
              city: null,
              country: null,
              zip: null,
              region: null,
              street: null,
              customer_id: null
            },
            ecommerce: {
              collection_id: "639084069193",
              item_list_name: "Alle Produkte",
              currency: "USD",
              items: [
                {
                  item_id: "999993333",
                  item_sku: "red_potion_3_50ml_Eng",
                  item_variant: "8888884444",
                  item_name: "Red potion™ Face Cream",
                  variant_name: "Default Title",
                  item_category: "",
                  item_brand: "Red potion",
                  price: 69.9,
                  imageURL: "img.png",
                  item_url: "/products/potion-3",
                  index: 1
                },
              ]
            },
            actual_url: window.location.url + 'list',
            ecomm_pagetype: "category",
          });
        } else if (event_name === 'purchase') {
          dataLayer.push({
            event: "purchase",
            user_data: {
              first_name: 'Testname',
              last_name: 'Test_lastname',
              email: 'test@mail.com',
              phone: '+1234567890',
              city: 'Vicecity',
              country: 'USA',
              zip: '12345',
              region: 'NJ',
              street: 'Wallstreet',
              customer_id: '19999'
            },
            ecommerce: {
              currency: "USD",
              items: [
                {
                  item_id: "999993333",
                  item_sku: "red_potion_3_50ml_Eng",
                  item_variant: "8888884444",
                  item_name: "Red potion™ Face Cream",
                  variant_name: "Default Title",
                  item_category: "",
                  item_brand: "Red potion",
                  price: 69.9,
                  imageURL: "img.png",
                  item_url: "/products/potion-3",
                  index: 1
                },
              ],
              transaction_id: "b3488dkfk93k20e",
              value: 69.9
            },
          });
        } else if (event_name === 'add_to_cart') {
          dataLayer.push({
            event: "add_to_cart_stape",
            user_data: {
              first_name: null,
              last_name: null,
              email: null,
              phone: null,
              city: null,
              country: null,
              zip: null,
              region: null,
              street: null,
              customer_id: null
            },
            ecommerce: {
              value: "69.9",
              currency: "EUR",
              items: [
                {
                  item_id: "999993335",
                  item_sku: "face cream",
                  item_variant: "1",
                  item_name: "Face Cream",
                  variant_name: null,
                  item_category: "Health & Beauty",
                  item_brand: "Buty",
                  item_url: "/products/face-cream?variant=1",
                  price: 69.9,
                  imageURL: "#",
                  quantity: 1
                }
              ]
            },
            actual_url: "https://stape.ink/products/face-cream",
            ecomm_pagetype: "product",
          });
        } else if (event_name === 'purchase_ga4') {
          dataLayer.push({
            event: "purchase",
            ecommerce: {
              transaction_id: "T_12345",
              // Sum of (price * quantity) for all items.
              value: 72.05,
              tax: 3.60,
              shipping: 5.99,
              currency: "USD",
              coupon: "SUMMER_SALE",
              items: [
              {
                item_id: "SKU_12345",
                item_name: "Stan and Friends Tee",
                affiliation: "Google Merchandise Store",
                coupon: "SUMMER_FUN",
                discount: 2.22,
                index: 0,
                item_brand: "Google",
                item_category: "Apparel",
                item_category2: "Adult",
                item_category3: "Shirts",
                item_category4: "Crew",
                item_category5: "Short sleeve",
                item_list_id: "related_products",
                item_list_name: "Related Products",
                item_variant: "green",
                location_id: "ChIJIQBpAG2ahYAR_6128GcTUEo",
                price: 10.01,
                quantity: 3
              },
              {
                item_id: "SKU_12346",
                item_name: "Google Grey Women's Tee",
                affiliation: "Google Merchandise Store",
                coupon: "SUMMER_FUN",
                discount: 3.33,
                index: 1,
                item_brand: "Google",
                item_category: "Apparel",
                item_category2: "Adult",
                item_category3: "Shirts",
                item_category4: "Crew",
                item_category5: "Short sleeve",
                item_list_id: "related_products",
                item_list_name: "Related Products",
                item_variant: "gray",
                location_id: "ChIJIQBpAG2ahYAR_6128GcTUEo",
                price: 21.01,
                promotion_id: "P_12345",
                promotion_name: "Summer Sale",
                quantity: 2
              }]
            }
          });
        }  else if (event_name === 'purchase_UA') {
          dataLayer.push({
            event: "purchase",
            ecommerce: {
              'purchase': {
                'actionField': {
                  'id': 'T12345',                         // Transaction ID. Required for purchases and refunds.
                  'affiliation': 'Online Store',
                  'revenue': '35.43',                     // Total transaction value (incl. tax and shipping)
                  'tax':'4.90',
                  'shipping': '5.99',
                  'coupon': 'SUMMER_SALE'
                },
                'products': [{                            // List of productFieldObjects.
                  'name': 'Triblend Android T-Shirt',     // Name or ID is required.
                  'id': '12345',
                  'price': '15.25',
                  'brand': 'Google',
                  'category': 'Apparel',
                  'variant': 'Gray',
                  'quantity': 1,
                  'coupon': ''                            // Optional fields may be omitted or set to empty string.
                },
                {
                  'name': 'Donut Friday Scented T-Shirt',
                  'id': '67890',
                  'price': '33.75',
                  'brand': 'Google',
                  'category': 'Apparel',
                  'variant': 'Black',
                  'quantity': 1
                }]
              }
            }
          });
        } else if (event_name === 'reset') {
          window.dataLayer.push(function() {
            this.reset();
          });
          dataLayer.push({
            event: 'reset',
          });
        }
        
        log(event_name + ' event sent');
      }

    </script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>